#include <stdio.h>
#include "../perf/d.h"
#include "../src/sparknacl_c.h"

typedef unsigned char u8;
typedef long long i64;
typedef i64 gf[16];

// FIXED PK and SK for this test.
unsigned char pk[32] =
  {0x83, 0xC7, 0x01, 0x8B, 0x06, 0x9D, 0xBF, 0xC0,
   0x72, 0x96, 0x5F, 0x40, 0xDF, 0xB5, 0x99, 0x05,
   0x7B, 0x5B, 0xB3, 0x7E, 0x82, 0x2F, 0xEA, 0x01,
   0x3E, 0x5B, 0xE5, 0x20, 0x83, 0x04, 0x0C, 0xF6};

unsigned char sk[64] =
  {0x56, 0x89, 0x60, 0x72, 0xD7, 0xE1, 0xB5, 0x35,
   0x2B, 0x12, 0xB6, 0xFC, 0x69, 0x94, 0xF3, 0x76,
   0xA7, 0x5C, 0x42, 0xDF, 0x70, 0x1E, 0xAC, 0xF0,
   0xA0, 0xEF, 0x30, 0xC6, 0xA1, 0xD8, 0x27, 0xF6,
   0xD6, 0x40, 0xDA, 0xF4, 0x0B, 0x0B, 0x35, 0xEF,
   0x03, 0x25, 0x5B, 0xEF, 0xA3, 0x4E, 0x31, 0xD4,
   0x35, 0xA1, 0xA2, 0xE2, 0xFF, 0xAA, 0xEA, 0x72,
   0x82, 0x82, 0xD2, 0xD0, 0x93, 0x6C, 0x19, 0x10};

unsigned char m[256] =
  {0x55, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa,
   0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa, 0xaa};

unsigned char sm[320];
unsigned char m2[320];

int main()
{
  unsigned long long smlen;
//  unsigned long long m2len;
//  int s;

  dh ("SK is ", sk, 64);
  dh ("PK is ", pk, 32);
  dh ("M is ", m, 256);

  crypto_sign (sm, &smlen, m, 256, sk);

  dh ("SM is ", sm, 320);

  s = crypto_sign_open (m2, &m2len, sm, 320, pk);
  dh ("M2 is ", m2, 320);
  dll ("Status is ", (long long) s);
  dll ("ML is ", (long long) m2len);
  return 0;
}
